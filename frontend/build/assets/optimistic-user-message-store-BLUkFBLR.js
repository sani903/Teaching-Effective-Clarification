import{u as S}from"./open-hands-axios-DsgPCc-0.js";import{u as d}from"./brand-button-BLaTuvKj.js";import{D as h}from"./module-CWLbpm_7.js";import{U as O,V as j,C}from"./feature-flags-1f3MRGYs.js";import{p as a,R as c}from"./chunk-NISHYRIK-CgksP-ke.js";import{b as x,a as k,c as M}from"./index-CQq-b-9n.js";function p(){return p=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},p.apply(null,arguments)}function T(t,e){if(t==null)return{};var s={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.indexOf(n)!==-1)continue;s[n]=t[n]}return s}const A=()=>{const t=S();return d({mutationKey:["create-conversation"],mutationFn:async e=>{const{query:s,repository:n,suggestedTask:o,conversationInstructions:u,createMicroagent:l}=e;if(O()&&!l){const i=await j.createConversation(n?.name,n?.gitProvider,s,n?.branch,u,void 0);return{conversation_id:`task-${i.id}`,session_api_key:null,url:i.agent_server_url,v1_task_id:i.id,is_v1:!0}}return{...await C.createConversation(n?.name,n?.gitProvider,s,o,n?.branch,u,l),is_v1:!1}},onSuccess:async(e,{query:s,repository:n})=>{h.capture("initial_query_submitted",{entry_point:"task_form",query_character_length:s?.length,has_repository:!!n}),t.removeQueries({queryKey:["user","conversations"]})}})};function B({gitProvider:t,className:e}){return a.jsxs(a.Fragment,{children:[t==="github"&&a.jsx(x,{size:14,className:e}),t==="gitlab"&&a.jsx(k,{className:e}),t==="bitbucket"&&a.jsx(M,{className:e})]})}const v=t=>{let e;const s=new Set,n=(i,b)=>{const r=typeof i=="function"?i(e):i;if(!Object.is(r,e)){const _=e;e=b??(typeof r!="object"||r===null)?r:Object.assign({},e,r),s.forEach(y=>y(e,_))}},o=()=>e,m={setState:n,getState:o,getInitialState:()=>g,subscribe:i=>(s.add(i),()=>s.delete(i))},g=e=t(n,o,m);return m},U=(t=>t?v(t):v),I=t=>t;function V(t,e=I){const s=c.useSyncExternalStore(t.subscribe,c.useCallback(()=>e(t.getState()),[t,e]),c.useCallback(()=>e(t.getInitialState()),[t,e]));return c.useDebugValue(s),s}const f=t=>{const e=U(t),s=n=>V(e,n);return Object.assign(s,e),s},q=(t=>t?f(t):f),w={optimisticUserMessage:null},K=q((t,e)=>({...w,setOptimisticUserMessage:s=>t(()=>({optimisticUserMessage:s})),getOptimisticUserMessage:()=>e().optimisticUserMessage,removeOptimisticUserMessage:()=>t(()=>({optimisticUserMessage:null}))}));export{B as G,p as _,K as a,T as b,q as c,A as u};
