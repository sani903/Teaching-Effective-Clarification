import{p as t,w as ae,R as o}from"./chunk-NISHYRIK-CgksP-ke.js";import{u as ne}from"./use-save-settings-C2NDO2vm.js";import{u as ie,D as T}from"./use-settings-y2Eq7ITW.js";import{A as u}from"./index-Cfwn16jo.js";import{B as oe}from"./brand-button-BLaTuvKj.js";import{I as le,S as g}from"./input-skeleton-gXNr_glO.js";import{S as m}from"./settings-input-Blv1eH9r.js";import{I as i}from"./declaration-BLNM_M5s.js";import{S as ce}from"./settings-dropdown-input-DCArA_yj.js";import{u as w}from"./useTranslation-BhtO8iYN.js";import{h as re}from"./handle-capture-consent-DZaBHqCI.js";import{d as Se,a as ge}from"./custom-toast-handlers-B_1yfMGT.js";import{r as ue}from"./retrieve-axios-error-message-CYr77e_f.js";import{S as b}from"./switch-skeleton-DlDbJHwW.js";import{u as de}from"./use-config-BtaDlBUv.js";import{p as L}from"./settings-utils-DdSYLo-D.js";import"./open-hands-axios-DsgPCc-0.js";import"./module-CWLbpm_7.js";import"./use-is-authed-CJdzFdqm.js";import"./i18next-Lgj2Bm8L.js";import"./preload-helper-BhQ1_4_d.js";import"./utils-C5iw9p3M.js";import"./optional-tag-C2att6n-.js";import"./chunk-S6H5EOGR-BBckzTk7.js";import"./useSingleSelectListState-D8PQAT0i.js";import"./index-BBSevn_K.js";import"./index-DJ6Yt2gU.js";import"./option-service.api-L97_35Hu.js";function Ie({defaultKey:n,onChange:d,name:l}){const{t:s}=w();return t.jsx(ce,{testId:l,name:l,onInputChange:d,label:s(i.SETTINGS$LANGUAGE),items:u.map(r=>({key:r.value,label:r.label})),defaultSelectedKey:n,isClearable:!1,wrapperClassName:"w-full max-w-[680px]"})}function Te(){return t.jsxs("div",{"data-testid":"app-settings-skeleton",className:"px-11 py-9 flex flex-col gap-6",children:[t.jsx(le,{}),t.jsx(b,{}),t.jsx(b,{})]})}function me(){const{t:n}=w(),{mutate:d,isPending:l}=ne(),{data:s,isLoading:r}=ie(),{data:E}=de(),[y,p]=o.useState(!1),[O,A]=o.useState(!1),[R,N]=o.useState(!1),[U,h]=o.useState(!1),[v,B]=o.useState(!1),[V,f]=o.useState(!1),[j,_]=o.useState(!1),[H,C]=o.useState(!1),M=e=>{const a=e.get("language-input")?.toString(),c=u.find(({label:I})=>I===a)?.value||T.LANGUAGE,G=e.get("enable-analytics-switch")?.toString()==="on",z=e.get("enable-sound-notifications-switch")?.toString()==="on",J=e.get("enable-proactive-conversations-switch")?.toString()==="on",Q=e.get("enable-solvability-analysis-switch")?.toString()==="on",W=e.get("max-budget-per-task-input")?.toString(),Z=L(W||""),ee=e.get("git-user-name-input")?.toString()||T.GIT_USER_NAME,te=e.get("git-user-email-input")?.toString()||T.GIT_USER_EMAIL;d({LANGUAGE:c,user_consents_to_analytics:G,ENABLE_SOUND_NOTIFICATIONS:z,ENABLE_PROACTIVE_CONVERSATION_STARTERS:J,ENABLE_SOLVABILITY_ANALYSIS:Q,MAX_BUDGET_PER_TASK:Z,GIT_USER_NAME:ee,GIT_USER_EMAIL:te},{onSuccess:()=>{re(G),ge(n(i.SETTINGS$SAVED))},onError:I=>{const se=ue(I);Se(se||n(i.ERROR$GENERIC))},onSettled:()=>{p(!1),A(!1),N(!1),h(!1),f(!1),_(!1),C(!1)}})},P=e=>{const a=u.find(({label:c})=>c===e)?.label,S=u.find(({value:c})=>c===s?.LANGUAGE)?.label;p(a!==S)},k=e=>{const a=!!s?.USER_CONSENTS_TO_ANALYTICS;A(e!==a)},$=e=>{const a=!!s?.ENABLE_SOUND_NOTIFICATIONS;N(e!==a)},D=e=>{const a=!!s?.ENABLE_PROACTIVE_CONVERSATION_STARTERS;h(e!==a)},Y=e=>{const a=!!s?.ENABLE_SOLVABILITY_ANALYSIS;B(e!==a)},K=e=>{const a=L(e),S=s?.MAX_BUDGET_PER_TASK;f(a!==S)},F=e=>{const a=s?.GIT_USER_NAME;_(e!==a)},X=e=>{const a=s?.GIT_USER_EMAIL;C(e!==a)},q=!y&&!O&&!R&&!U&&!v&&!V&&!j&&!H,x=!s||r||l;return t.jsxs("form",{"data-testid":"app-settings-screen",action:M,className:"flex flex-col h-full justify-between",children:[x&&t.jsx(Te,{}),!x&&t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx(Ie,{name:"language-input",defaultKey:s.LANGUAGE,onChange:P}),t.jsx(g,{testId:"enable-analytics-switch",name:"enable-analytics-switch",defaultIsToggled:!!s.USER_CONSENTS_TO_ANALYTICS,onToggle:k,children:n(i.ANALYTICS$SEND_ANONYMOUS_DATA)}),t.jsx(g,{testId:"enable-sound-notifications-switch",name:"enable-sound-notifications-switch",defaultIsToggled:!!s.ENABLE_SOUND_NOTIFICATIONS,onToggle:$,children:n(i.SETTINGS$SOUND_NOTIFICATIONS)}),E?.APP_MODE==="saas"&&t.jsx(g,{testId:"enable-proactive-conversations-switch",name:"enable-proactive-conversations-switch",defaultIsToggled:!!s.ENABLE_PROACTIVE_CONVERSATION_STARTERS,onToggle:D,children:n(i.SETTINGS$PROACTIVE_CONVERSATION_STARTERS)}),E?.APP_MODE==="saas"&&t.jsx(g,{testId:"enable-solvability-analysis-switch",name:"enable-solvability-analysis-switch",defaultIsToggled:!!s.ENABLE_SOLVABILITY_ANALYSIS,onToggle:Y,children:n(i.SETTINGS$SOLVABILITY_ANALYSIS)}),t.jsx(m,{testId:"max-budget-per-task-input",name:"max-budget-per-task-input",type:"number",label:n(i.SETTINGS$MAX_BUDGET_PER_CONVERSATION),defaultValue:s.MAX_BUDGET_PER_TASK?.toString()||"",onChange:K,placeholder:n(i.SETTINGS$MAXIMUM_BUDGET_USD),min:1,step:1,className:"w-full max-w-[680px]"}),t.jsxs("div",{className:"border-t border-t-tertiary pt-6 mt-2",children:[t.jsx("h3",{className:"text-lg font-medium mb-2",children:n(i.SETTINGS$GIT_SETTINGS)}),t.jsx("p",{className:"text-xs mb-4",children:n(i.SETTINGS$GIT_SETTINGS_DESCRIPTION)}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx(m,{testId:"git-user-name-input",name:"git-user-name-input",type:"text",label:n(i.SETTINGS$GIT_USERNAME),defaultValue:s.GIT_USER_NAME||"",onChange:F,placeholder:"Username for git commits",className:"w-full max-w-[680px]"}),t.jsx(m,{testId:"git-user-email-input",name:"git-user-email-input",type:"email",label:n(i.SETTINGS$GIT_EMAIL),defaultValue:s.GIT_USER_EMAIL||"",onChange:X,placeholder:"Email for git commits",className:"w-full max-w-[680px]"})]})]})]}),t.jsx("div",{className:"flex gap-6 p-6 justify-end",children:t.jsxs(oe,{testId:"submit-button",variant:"primary",type:"submit",isDisabled:l||q,children:[!l&&n("SETTINGS$SAVE_CHANGES"),l&&n("SETTINGS$SAVING")]})})]})}const Ke=ae(me);export{Ke as default};
